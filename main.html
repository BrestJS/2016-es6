<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ES6</title>
    <link rel="stylesheet" href="node_modules/slide/src/slide.css" />
    <script src="node_modules/marked/lib/marked.js"></script>
    <script src="node_modules/slide/src/slide.js"></script>
  </head>
<body class="slide-16x9">
<script type="text/markdown" id="slide">
ES6 ğŸŠ
===
github.comâ€‰/â€‰BrestJSâ€‰/â€‰2016-es6
by _shimaore_

introduction

ES6 â‰¡ ES2015

ğŸŒ® annuelle
ğŸŒ´ github.com/tc39/ecma262

ES6 ğŸŠ

```javascript
class Personne {
  constructor (name = 'cher amiÂ·e') {
    this.name = name
  }
  greet () {
    return `Bonjour, ${this.name}.`
  }
}
// typeof Personne === 'function'
// Personne.name === 'Personne'
// new Personne('Annie').greet()
//         === 'Bonjour, Annie.'
```

```
class Client extends Personne {
  constructor (name) {
    super(name)
  }
}
// new Client.greet()
//    === 'Bonjour, cher amiâ€¢e'
```

```javascript
const ready = (when) => when === 'now'
const api_ready = ready('now')
// api_ready === true
â€¦
â€¦
```

```javascript
const ready = (when) => when === 'now'
const api_ready = ready('now')
const api_ready = false
// SyntaxError: Identifier 'api_ready'
// has already been declared
```

```javascript
[4,3,2].filter( x => x*2 > 5 )
[4,3,2].map( (x,i) => x*i )
```

```javascript
for (let i = 0; i < a.length; i++) {
  let x = a[i]
}
// typeof i === 'undefined'
// typeof x === 'undefined'
```

```javascript
{
  function a() { return 1 }
  {
    function a() { return 2 }
  }
}
```

```javascript
class requÃªte {
  get (url,cb) { cb('Bonjour') }
}
class app {
  constructor (name) { this.name = name }
  run () {
    new requÃªte()
      .get('http://example.org', text =>
        console.log(`${text}, ${this.name}!`)
      )
  }
}
new App('Fanny').run()
```

ğŸ„ ğŸ…
==
* GET /personne â†’ {nom,prÃ©nom}
* GET /liste â†’ [article,â€¦]
* GET /article?article=xyz â†’ {description,prix}

```javascript
let result = ''
new requÃªte()
.get('/personne', ({nom,prÃ©nom}) => {
  result += `Liste de noÃ«l pour ${prÃ©nom} ${nom}\n`
  new requÃªte()
  .get('/liste', (liste) => {
    â€¦
```

```
    â€¦
    let reÃ§us = 0;
    for (let article of liste) {
      new requÃªte()
      .get('/article',{article}, ({description,prix}) => {
        reÃ§us += 1
        result += `${reÃ§us}. ${description} Ã  ${prix}â‚¬\n`
})}})})
```

ğŸŒª
==
Liste de noÃ«l pour Fanny Dumoulin
1. Dictionnaire de latin Ã  36.57â‚¬
2. Mappemonde en bois Ã  42.42â‚¬
3. Joli vÃ©lo Ã  314.15â‚¬

```javascript
co = require('seem')
co( function* () {
  let result = ''
  let {nom,prÃ©nom} = yield new requÃªte()
    .get('/personne')
  result += `Liste de noÃ«l pour ${prÃ©nom} ${nom}\n`
  â€¦
```

```javascript
  â€¦
  let liste = yield new requÃªte()
    .get('/liste')
  let reÃ§us = 0;
  for (let article of liste) {
    let {description,prix} = yield new requÃªte()
        .get('/article',{article})
    reÃ§us += 1
    result += `${reÃ§us}. ${description} Ã  ${prix}â‚¬\n`
  }
  console.log(result)
} )()
```

ğŸŒ 
==
Liste de noÃ«l pour Fanny Dumoulin
1. Joli vÃ©lo Ã  314.15â‚¬
2. Mappemonde en bois Ã  42.42â‚¬
3. Dictionnaire de latin Ã  36.57â‚¬

Promises
--------

```
let p = Promise.resolve()
p
.then( function () {
  return 1
}).then( function (result) {
  // result === 1
})
```

```
let p = Promise.resolve()
p
.then( function () {
  return Promise.resolve(1)
}).then( function (result) {
  // result === 1
})
```

```
let p = new Promise()
p
.then( function () {
  throw new Error("bam")
}).catch( function (error) {
  // error.message === "bam"
})
```

Utiliser les Promises

```
promise.then( on_resolve )
promise.catch( on_reject )
promise.then( on_resolve,
              on_reject )
```

CrÃ©er des Promises

```
Promise.resolve( value )
Promise.reject( error )
new Promise( (resolve,reject) => )
```

```
const sleep = (timeout) =>
  new Promise( (resolve,reject) =>
    setTimeout(resolve,timeout)
  )
```

```
const sleep = (timeout) =>
  new Promise( (resolve,reject) =>
    setTimeout(resolve,timeout)
  )
sleep(10*seconds)
.then( function() {
  console.log('10 secondes plus tard')
})
```

```
const sleep = (timeout) =>
  new Promise( (resolve,reject) =>
    setTimeout(resolve,timeout)
  )
co( function*() {
  yield sleep(10*secondes)
  console.log('10 secondes plus tard')
})
```

```
const wait_for = (ev,name) =>
  new Promise( (resolve,reject) =>
    ev.once('error',reject)
    ev.once(name,resolve)
  )
```

```
const wait_for = (ev,name) =>
  new Promise( (resolve,reject) =>
    ev.once('error',reject)
    ev.once(name,resolve)
  )
co( function*() {
  yield wait_for(ev,'noÃ«l')
  console.log('Enfin!'')
  yield livrer_les_cadeaux()
})
ev.emit('noÃ«l')
```

`Map` is the new `{}`
---------------------
ğŸ’“ performance!

```
let o = new Map()
o.set(key,val)
val = o.get(key)
for( let [key,val] of o.entries() )
  â€¦
```

Destructuration
---------------

```
let [a,b] = [12,34]
let {c,d} = {c:12,d:34}
function example({a,b}) {â€¦}
example({a:12,b:34})
```

```
[a,...b] = [12,34,42,56]
function example(...args) {â€¦}
```

Utiliser
========

* Node.js 6.5+ â†’ node.green/
* Babel â†’ babeljs.io/docs/learn-es2015/
* regenerator (`function*()` sur prÃ©-ES6)

```
# .babelrc
{
  "presets": [
      [ "es2015", { "modules": false } ]
    ],
   "plugins": [
     "transform-regenerator"
   ]
}
```

```
npm install --save-dev \
  babel-core babel-loader
  babel-plugin-transform-regenerator \
  babel-polyfill babel-preset-es2015
```

```
# using babel in webpack.config.js
module.exports = {
  â€¦
  module: {
    loaders: [
      {
        test: /\.js$/,
        exclude: /(node_modules|bower_components)/,
        loader: 'babel-loader'
}]}}
```

references.md

ââ€‰Questions?â€‰â
==============
github.comâ€‰/â€‰BrestJSâ€‰/â€‰2016-es6

â¦ Merci! â§
==========
github.comâ€‰/â€‰BrestJSâ€‰/â€‰2016-es6
github.comâ€‰/â€‰shimaore
</script>
</body>
</html>
